pipeline {
    agent {
        node{
        label 'maven-server'
    }
    }
    tools {
        maven "mvn"
    }
    stages {
        
        stage('Git clone') {
            steps {
            git credentialsId: 'github-jenkins', url: "${Repo}"
            }
        }
        
        stage('Build') {
            steps {
                script{
                    sh "/opt/apache-maven-3.8.6/bin/mvn clean install"
                }
            }
        }
        
        stage('Sonar'){
            steps{
                script {
                withSonarQubeEnv(credentialsId: 'sonarqube') {
                sh 'mvn sonar:sonar -Dsonar.projectName=test -Dsonar.projectKey=test'
                }
                }
            }
        }
    }
}
